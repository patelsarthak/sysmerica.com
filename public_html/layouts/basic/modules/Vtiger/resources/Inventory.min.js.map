{"version":3,"file":"Inventory.min.js","sources":["Inventory.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\n$.Class(\n\t'Vtiger_Inventory_Js',\n\t{\n\t\tinventoryInstance: false,\n\t\t/**\n\t\t * Get inventory instance\n\t\t * @param {jQuery} container\n\t\t * @returns {Vtiger_Inventory_Js}\n\t\t */\n\t\tgetInventoryInstance: function(container) {\n\t\t\tif (this.inventoryInstance === false) {\n\t\t\t\tlet moduleClassName = container.find('[name=\"module\"]').val() + '_Inventory_Js';\n\t\t\t\tif (typeof window[moduleClassName] === 'undefined') {\n\t\t\t\t\tmoduleClassName = 'Vtiger_Inventory_Js';\n\t\t\t\t}\n\t\t\t\tif (typeof window[moduleClassName] !== 'undefined') {\n\t\t\t\t\tthis.inventoryInstance = new window[moduleClassName]();\n\t\t\t\t\tthis.inventoryInstance.registerEvents(container);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this.inventoryInstance;\n\t\t}\n\t},\n\t{\n\t\tform: false,\n\t\tinventoryContainer: false,\n\t\tinventoryHeadContainer: false,\n\t\tsummaryTaxesContainer: false,\n\t\tsummaryDiscountContainer: false,\n\t\tsummaryCurrenciesContainer: false,\n\t\trowClass: 'tr.inventoryRow',\n\t\tdiscountModalFields: [\n\t\t\t'aggregationType',\n\t\t\t'globalDiscount',\n\t\t\t'groupCheckbox',\n\t\t\t'groupDiscount',\n\t\t\t'individualDiscount',\n\t\t\t'individualDiscountType'\n\t\t],\n\t\ttaxModalFields: ['aggregationType', 'globalTax', 'groupCheckbox', 'groupTax', 'individualTax', 'regionalTax'],\n\t\t/**\n\t\t * Get current form element\n\t\t * @returns {jQuery}\n\t\t */\n\t\tgetForm() {\n\t\t\treturn this.form;\n\t\t},\n\t\t/**\n\t\t * Function that is used to get the line item container\n\t\t * @return : jQuery object\n\t\t */\n\t\tgetInventoryItemsContainer: function() {\n\t\t\tif (this.inventoryContainer === false) {\n\t\t\t\tthis.inventoryContainer = $('.inventoryItems');\n\t\t\t}\n\t\t\treturn this.inventoryContainer;\n\t\t},\n\t\tgetInventoryHeadContainer: function() {\n\t\t\tif (this.inventoryHeadContainer === false) {\n\t\t\t\tthis.inventoryHeadContainer = $('.inventoryHeader');\n\t\t\t}\n\t\t\treturn this.inventoryHeadContainer;\n\t\t},\n\t\tgetInventorySummaryDiscountContainer: function() {\n\t\t\tif (this.summaryDiscountContainer === false) {\n\t\t\t\tthis.summaryDiscountContainer = $('.inventorySummaryDiscounts');\n\t\t\t}\n\t\t\treturn this.summaryDiscountContainer;\n\t\t},\n\t\tgetInventorySummaryTaxesContainer: function() {\n\t\t\tif (this.summaryTaxesContainer === false) {\n\t\t\t\tthis.summaryTaxesContainer = $('.inventorySummaryTaxes');\n\t\t\t}\n\t\t\treturn this.summaryTaxesContainer;\n\t\t},\n\t\tgetInventorySummaryCurrenciesContainer: function() {\n\t\t\tif (this.summaryCurrenciesContainer === false) {\n\t\t\t\tthis.summaryCurrenciesContainer = $('.inventorySummaryCurrencies');\n\t\t\t}\n\t\t\treturn this.summaryCurrenciesContainer;\n\t\t},\n\t\tgetNextLineItemRowNumber: function() {\n\t\t\tvar $inventoryItemsNo = $('#inventoryItemsNo');\n\t\t\tvar rowNumber = parseInt($inventoryItemsNo.val()) + 1;\n\t\t\t$inventoryItemsNo.val(rowNumber);\n\t\t\treturn rowNumber;\n\t\t},\n\t\tgetAccountId: function() {\n\t\t\tvar accountReferenceField = $('#accountReferenceField').val();\n\t\t\tif (accountReferenceField != '') {\n\t\t\t\treturn $('[name=\"' + accountReferenceField + '\"]').val();\n\t\t\t}\n\t\t\treturn '';\n\t\t},\n\t\tcheckDeleteIcon: function() {\n\t\t\tif (this.getInventoryItemsContainer().find(this.rowClass).length > 1) {\n\t\t\t\tthis.showLineItemsDeleteIcon();\n\t\t\t} else if (app.getMainParams('isRequiredInventory')) {\n\t\t\t\tthis.hideLineItemsDeleteIcon();\n\t\t\t}\n\t\t},\n\t\tshowLineItemsDeleteIcon: function() {\n\t\t\tthis.getInventoryItemsContainer()\n\t\t\t\t.find('.deleteRow')\n\t\t\t\t.removeClass('d-none');\n\t\t},\n\t\thideLineItemsDeleteIcon: function() {\n\t\t\tthis.getInventoryItemsContainer()\n\t\t\t\t.find('.deleteRow')\n\t\t\t\t.addClass('d-none');\n\t\t},\n\t\tgetClosestRow: function(element) {\n\t\t\treturn element.closest(this.rowClass);\n\t\t},\n\t\t/**\n\t\t * Function which will return the basic row which can be used to add new rows\n\t\t * @return jQuery object which you can use to\n\t\t */\n\t\tgetBasicRow: function() {\n\t\t\treturn this.getForm()\n\t\t\t\t.find('.js-inventory-base-item')\n\t\t\t\t.eq(0)\n\t\t\t\t.clone(true, true);\n\t\t},\n\t\tisRecordSelected: function(element) {\n\t\t\tvar parentRow = element.closest('tr');\n\t\t\tvar productField = parentRow.find('.recordLabel');\n\t\t\treturn productField.validationEngine('validate');\n\t\t},\n\t\tgetTaxModeSelectElement: function(row) {\n\t\t\tvar items = this.getInventoryHeadContainer();\n\t\t\tif (items.find('thead .js-taxmode').length > 0) {\n\t\t\t\treturn $('.js-taxmode');\n\t\t\t}\n\t\t\tif (row) {\n\t\t\t\treturn row.find('.js-taxmode');\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tisIndividualTaxMode: function(row) {\n\t\t\tvar taxModeElement = this.getTaxModeSelectElement(row);\n\t\t\tvar selectedOption = taxModeElement.find('option:selected');\n\t\t\treturn selectedOption.val() == '1';\n\t\t},\n\t\tisGroupTaxMode: function() {\n\t\t\tvar taxTypeElement = this.getTaxModeSelectElement();\n\t\t\tif (taxTypeElement) {\n\t\t\t\tvar selectedOption = taxTypeElement.find('option:selected');\n\t\t\t\tif (selectedOption.val() == '0') {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\tshowIndividualTax: function(row) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar groupTax = thisInstance.getInventorySummaryTaxesContainer().find('.groupTax');\n\t\t\tvar items = thisInstance.getInventoryItemsContainer();\n\t\t\tvar newRow = $('#blackIthemTable').find('tbody');\n\t\t\tif (thisInstance.isIndividualTaxMode()) {\n\t\t\t\tgroupTax.addClass('d-none');\n\t\t\t\titems.find('.changeTax').removeClass('d-none');\n\t\t\t\tnewRow.find('.changeTax').removeClass('d-none');\n\t\t\t\tlet parentRow = thisInstance.getInventoryItemsContainer();\n\t\t\t\tlet taxParam = { aggregationType: 'global' };\n\n\t\t\t\tparentRow.find(thisInstance.rowClass).each(function() {\n\t\t\t\t\tlet thisItem = $(this);\n\t\t\t\t\ttaxParam['globalTax'] = thisItem.find('.js-tax').attr('data-default-tax');\n\t\t\t\t\tthisInstance.setTaxParam(thisItem, taxParam);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthisInstance.setTax(items, 0);\n\t\t\t\tthisInstance.setTaxPercent(items, 0);\n\t\t\t\tthisInstance.setTaxParam(items, []);\n\t\t\t\tthisInstance.setDefaultGlobalTax(row);\n\t\t\t\tgroupTax.removeClass('d-none');\n\t\t\t\titems.find('.changeTax').addClass('d-none');\n\t\t\t\tnewRow.find('.changeTax').addClass('d-none');\n\t\t\t}\n\t\t\tthisInstance.rowsCalculations();\n\t\t},\n\t\tsetDefaultGlobalTax: function(row) {\n\t\t\tlet thisInstance = this;\n\t\t\tlet parentRow = thisInstance.getInventoryItemsContainer();\n\t\t\tlet taxDefaultValue = thisInstance\n\t\t\t\t.getInventorySummaryTaxesContainer()\n\t\t\t\t.find('.js-default-tax')\n\t\t\t\t.data('tax-default-value');\n\t\t\tlet isGroupTax = thisInstance.isGroupTaxMode();\n\t\t\tif (isGroupTax) {\n\t\t\t\tif (taxDefaultValue) {\n\t\t\t\t\tlet taxParam = { aggregationType: 'global' };\n\t\t\t\t\ttaxParam['globalTax'] = taxDefaultValue;\n\t\t\t\t\ttaxParam['individualTax'] = '';\n\t\t\t\t\tthisInstance.setTaxParam($('#blackIthemTable'), taxParam);\n\t\t\t\t\tthisInstance.setTaxParam(parentRow, taxParam);\n\t\t\t\t\tparentRow.closest('.inventoryItems').data('taxParam', JSON.stringify(taxParam));\n\t\t\t\t\tparentRow.find(thisInstance.rowClass).each(function() {\n\t\t\t\t\t\tthisInstance.quantityChangeActions($(this));\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthisInstance.setTaxParam($('#blackIthemTable'), []);\n\t\t\t\tparentRow.closest('.inventoryItems').data('taxParam', []);\n\t\t\t}\n\t\t},\n\t\tgetDiscountModeSelectElement: function(row) {\n\t\t\tvar items = this.getInventoryHeadContainer();\n\t\t\tif (items.find('thead .js-discountmode').length > 0) {\n\t\t\t\treturn $('.js-discountmode');\n\t\t\t}\n\t\t\treturn row.find('.js-discountmode');\n\t\t},\n\t\tisIndividualDiscountMode: function(row) {\n\t\t\tvar discountModeElement = this.getDiscountModeSelectElement(row);\n\t\t\tvar selectedOption = discountModeElement.find('option:selected');\n\t\t\treturn selectedOption.val() == '1';\n\t\t},\n\t\tshowIndividualDiscount: function(row) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar groupDiscount = thisInstance.getInventorySummaryDiscountContainer().find('.groupDiscount');\n\t\t\tvar items = thisInstance.getInventoryItemsContainer();\n\t\t\tvar newRow = $('#blackIthemTable').find('tbody');\n\t\t\tif (thisInstance.isIndividualDiscountMode(row)) {\n\t\t\t\tgroupDiscount.addClass('d-none');\n\t\t\t\titems.find('.changeDiscount').removeClass('d-none');\n\t\t\t\tnewRow.find('.changeDiscount').removeClass('d-none');\n\t\t\t} else {\n\t\t\t\tgroupDiscount.removeClass('d-none');\n\t\t\t\titems.find('.changeDiscount').addClass('d-none');\n\t\t\t\tnewRow.find('.changeDiscount').addClass('d-none');\n\t\t\t}\n\t\t\tthisInstance.setDiscount(items, 0);\n\t\t\tthisInstance.setDiscountParam(items, []);\n\t\t\tthisInstance.rowsCalculations();\n\t\t},\n\t\tgetCurrency: function() {\n\t\t\tlet currency = $('.js-currency', this.getInventoryHeadContainer());\n\t\t\treturn currency.find('option:selected').val();\n\t\t},\n\t\tgetTax: function(row) {\n\t\t\tvar taxParams = row.find('.taxParam').val();\n\t\t\tif (taxParams == '' || taxParams == '[]' || taxParams == undefined) return 0;\n\t\t\ttaxParams = JSON.parse(taxParams);\n\t\t\tvar aggregationType = $('.aggregationTypeTax').val();\n\t\t\tvar valuePrices = this.getNetPrice(row);\n\t\t\tvar taxRate = 0;\n\t\t\tvar types = taxParams.aggregationType;\n\t\t\tif (typeof types == 'string') {\n\t\t\t\ttypes = [types];\n\t\t\t}\n\t\t\tif (types) {\n\t\t\t\ttypes.forEach(function(entry) {\n\t\t\t\t\tvar taxValue = 0;\n\t\t\t\t\tswitch (entry) {\n\t\t\t\t\t\tcase 'individual':\n\t\t\t\t\t\t\ttaxValue = taxParams.individualTax;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'global':\n\t\t\t\t\t\t\ttaxValue = taxParams.globalTax;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'group':\n\t\t\t\t\t\t\ttaxValue = taxParams.groupTax;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'regional':\n\t\t\t\t\t\t\ttaxValue = taxParams.regionalTax;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\ttaxRate += valuePrices * (taxValue / 100);\n\t\t\t\t\tif (aggregationType == '2') {\n\t\t\t\t\t\tvaluePrices = valuePrices + taxRate;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn taxRate;\n\t\t},\n\t\tgetTaxPercent: function(row) {\n\t\t\tvar taxParams = row.find('.taxParam').val();\n\t\t\tif (taxParams == '' || taxParams == '[]' || taxParams == undefined) return 0;\n\t\t\ttaxParams = JSON.parse(taxParams);\n\t\t\tlet taxPercent = taxParams[taxParams.aggregationType + 'Tax'];\n\t\t\treturn taxPercent ? taxPercent : 0;\n\t\t},\n\t\tgetTaxParams: function(row) {\n\t\t\tvar taxParams = row.find('.taxParam').val();\n\t\t\tif (taxParams == '' || taxParams == '[]' || taxParams == undefined) return false;\n\t\t\treturn JSON.parse(taxParams);\n\t\t},\n\t\tgetQuantityValue: function(row) {\n\t\t\treturn $('.qty', row).getNumberFromValue();\n\t\t},\n\t\tgetUnitPriceValue: function(row) {\n\t\t\treturn $('.unitPrice', row).getNumberFromValue();\n\t\t},\n\t\tgetDiscount: function(row) {\n\t\t\tvar discountParams = row.find('.discountParam').val();\n\t\t\tvar aggregationType = $('.aggregationTypeDiscount').val();\n\t\t\tif (\n\t\t\t\tdiscountParams == '' ||\n\t\t\t\tdiscountParams == 'null' ||\n\t\t\t\tdiscountParams == '[]' ||\n\t\t\t\tdiscountParams == undefined\n\t\t\t)\n\t\t\t\treturn 0;\n\t\t\tdiscountParams = JSON.parse(discountParams);\n\t\t\tvar valuePrices = this.getTotalPrice(row);\n\t\t\tvar discountRate = 0;\n\t\t\tvar types = discountParams.aggregationType;\n\t\t\tif (typeof types == 'string') {\n\t\t\t\ttypes = [types];\n\t\t\t}\n\t\t\tif (types) {\n\t\t\t\ttypes.forEach(function(entry) {\n\t\t\t\t\tvar discountValue;\n\t\t\t\t\tif (entry == 'individual') {\n\t\t\t\t\t\tdiscountValue = discountParams.individualDiscount;\n\t\t\t\t\t\tvar discountType = discountParams.individualDiscountType;\n\t\t\t\t\t\tif (discountType == 'percentage') {\n\t\t\t\t\t\t\tdiscountRate += valuePrices * (discountValue / 100);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdiscountRate += discountValue;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (entry == 'global') {\n\t\t\t\t\t\tdiscountRate += valuePrices * (discountParams.globalDiscount / 100);\n\t\t\t\t\t}\n\t\t\t\t\tif (entry == 'group') {\n\t\t\t\t\t\tdiscountRate += valuePrices * (discountParams.groupDiscount / 100);\n\t\t\t\t\t}\n\t\t\t\t\tif (aggregationType == '2') {\n\t\t\t\t\t\tvaluePrices = valuePrices - discountRate;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn discountRate;\n\t\t},\n\t\tgetNetPrice: function(row) {\n\t\t\treturn this.getTotalPrice(row) - this.getDiscount(row);\n\t\t},\n\t\tgetTotalPrice: function(row) {\n\t\t\treturn this.getQuantityValue(row) * this.getUnitPriceValue(row);\n\t\t},\n\t\tgetGrossPrice: function(row) {\n\t\t\treturn $('.grossPrice', row).getNumberFromValue();\n\t\t},\n\t\tgetPurchase: function(row) {\n\t\t\tvar qty = this.getQuantityValue(row);\n\t\t\tvar element = $('.purchase', row);\n\t\t\tvar purchase = 0;\n\t\t\tif (element.length > 0) {\n\t\t\t\tpurchase = App.Fields.Double.formatToDb(element.val());\n\t\t\t}\n\t\t\treturn purchase * qty;\n\t\t},\n\t\tgetSummaryGrossPrice: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar price = 0;\n\t\t\tthis.getInventoryItemsContainer()\n\t\t\t\t.find(thisInstance.rowClass)\n\t\t\t\t.each(function(index) {\n\t\t\t\t\tprice += thisInstance.getGrossPrice($(this));\n\t\t\t\t});\n\t\t\treturn App.Fields.Double.formatToDb(price);\n\t\t},\n\t\t/**\n\t\t * Set currency\n\t\t * @param {int} val\n\t\t */\n\t\tsetCurrency(val) {\n\t\t\tthis.getInventoryHeadContainer()\n\t\t\t\t.find('.js-currency')\n\t\t\t\t.val(val)\n\t\t\t\t.trigger('change');\n\t\t},\n\t\t/**\n\t\t * Set currency param\n\t\t * @param {string} val json string\n\t\t */\n\t\tsetCurrencyParam(val) {\n\t\t\tthis.getInventoryHeadContainer()\n\t\t\t\t.find('.js-currencyparam')\n\t\t\t\t.val(val);\n\t\t},\n\t\t/**\n\t\t * Set discount mode\n\t\t * @param {int} val\n\t\t */\n\t\tsetDiscountMode(val) {\n\t\t\tthis.getInventoryHeadContainer()\n\t\t\t\t.find('.js-discountmode')\n\t\t\t\t.val(val)\n\t\t\t\t.trigger('change');\n\t\t},\n\t\t/**\n\t\t * Set tax mode\n\t\t * @param {int} val\n\t\t */\n\t\tsetTaxMode(val) {\n\t\t\tthis.getInventoryHeadContainer()\n\t\t\t\t.find('.js-taxmode')\n\t\t\t\t.val(val)\n\t\t\t\t.trigger('change');\n\t\t},\n\t\t/**\n\t\t * Set inventory id\n\t\t * @param {jQuery} row\n\t\t * @param {int} val\n\t\t * @param {string} display\n\t\t */\n\t\tsetName(row, val, display) {\n\t\t\trow.find('.js-name')\n\t\t\t\t.val(val)\n\t\t\t\t.trigger('change');\n\t\t\trow.find('.js-name_display')\n\t\t\t\t.val(display)\n\t\t\t\t.attr('readonly', 'true')\n\t\t\t\t.trigger('change');\n\t\t},\n\t\t/**\n\t\t * Set inventory row quantity\n\t\t * @param {jQuery} row\n\t\t * @param {int} val\n\t\t */\n\t\tsetQuantity(row, val) {\n\t\t\trow.find('.qty')\n\t\t\t\t.val(val)\n\t\t\t\t.trigger('change');\n\t\t},\n\t\t/**\n\t\t * Set unit original (db) value\n\t\t * @param {jQuery} row\n\t\t * @param {string} val\n\t\t * @param {string} display\n\t\t */\n\t\tsetUnit(row, val, display) {\n\t\t\trow.find('.unit')\n\t\t\t\t.val(val)\n\t\t\t\t.trigger('change');\n\t\t\trow.find('.unitText')\n\t\t\t\t.text(display)\n\t\t\t\t.trigger('change');\n\t\t},\n\t\t/**\n\t\t * Set subUnit original (db) value\n\t\t * @param {jQuery} row\n\t\t * @param {string} val\n\t\t * @param {string} display\n\t\t */\n\t\tsetSubUnit(row, val, display) {\n\t\t\trow.find('.subunit').val(val);\n\t\t\trow.find('.subunitText').val(display);\n\t\t},\n\t\t/**\n\t\t * Set inventory row comment\n\t\t * @param {jQuery} row\n\t\t * @param {string} val\n\t\t */\n\t\tsetComment(row, val) {\n\t\t\trow.parent()\n\t\t\t\t.find('[numrowex=' + row.attr('numrow') + ']')\n\t\t\t\t.find('.comment')\n\t\t\t\t.val(val)\n\t\t\t\t.trigger('change');\n\t\t},\n\t\tsetUnitPrice: function(row, val) {\n\t\t\tval = App.Fields.Double.formatToDisplay(val);\n\t\t\trow.find('.unitPrice')\n\t\t\t\t.val(val)\n\t\t\t\t.attr('title', val);\n\t\t\treturn this;\n\t\t},\n\t\tsetPurchase: function(row, val) {\n\t\t\tval = App.Fields.Double.formatToDisplay(val);\n\t\t\trow.find('.purchase').val(val);\n\t\t\treturn this;\n\t\t},\n\t\tsetNetPrice: function(row, val) {\n\t\t\tval = App.Fields.Double.formatToDisplay(val);\n\t\t\t$('.netPriceText', row).text(val);\n\t\t\t$('.netPrice', row).val(val);\n\t\t},\n\t\tsetGrossPrice: function(row, val) {\n\t\t\tval = App.Fields.Double.formatToDisplay(val);\n\t\t\t$('.grossPriceText', row).text(val);\n\t\t\t$('.grossPrice', row).val(val);\n\t\t},\n\t\tsetTotalPrice: function(row, val) {\n\t\t\tval = App.Fields.Double.formatToDisplay(val);\n\t\t\t$('.totalPriceText', row).text(val);\n\t\t\t$('.totalPrice', row).val(val);\n\t\t},\n\t\tsetMargin: function(row, val) {\n\t\t\tval = App.Fields.Double.formatToDisplay(val);\n\t\t\t$('.margin', row).val(val);\n\t\t},\n\t\tsetMarginP: function(row, val) {\n\t\t\tval = App.Fields.Double.formatToDisplay(val);\n\t\t\t$('.marginp', row).val(val);\n\t\t},\n\t\tsetDiscount: function(row, val) {\n\t\t\tval = App.Fields.Double.formatToDisplay(val);\n\t\t\t$('.discount', row).val(val);\n\t\t},\n\t\tsetDiscountParam: function(row, val) {\n\t\t\t$('.discountParam', row).val(JSON.stringify(val));\n\t\t},\n\t\tsetTax: function(row, val) {\n\t\t\t$('.tax', row).val(App.Fields.Double.formatToDisplay(val));\n\t\t},\n\t\tsetTaxPercent: function(row, val) {\n\t\t\tval = App.Fields.Double.formatToDisplay(val);\n\t\t\t$('.js-tax-percent', row).val(val);\n\t\t},\n\t\tsetTaxParam: function(row, val) {\n\t\t\t$('.taxParam', row).val(JSON.stringify(val));\n\t\t},\n\t\tquantityChangeActions: function(row) {\n\t\t\tthis.rowCalculations(row);\n\t\t\tthis.summaryCalculations();\n\t\t},\n\t\trowCalculations: function(row) {\n\t\t\tthis.calculateTotalPrice(row);\n\t\t\tthis.calculateDiscounts(row);\n\t\t\tthis.calculateNetPrice(row);\n\t\t\tthis.calculateTaxes(row);\n\t\t\tthis.calculateGrossPrice(row);\n\t\t\tthis.calculateMargin(row);\n\t\t},\n\t\trowsCalculations: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tthis.getInventoryItemsContainer()\n\t\t\t\t.find(thisInstance.rowClass)\n\t\t\t\t.each(function(index) {\n\t\t\t\t\tthisInstance.quantityChangeActions($(this));\n\t\t\t\t});\n\t\t\tthisInstance.calculateItemNumbers();\n\t\t},\n\t\tcalculateDiscounts: function(row) {\n\t\t\tthis.setDiscount(row, this.getDiscount(row));\n\t\t},\n\t\tcalculateTaxes: function(row) {\n\t\t\tthis.setTax(row, this.getTax(row));\n\t\t\tthis.setTaxPercent(row, this.getTaxPercent(row));\n\t\t},\n\t\tsummaryCalculations: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tthisInstance\n\t\t\t\t.getInventoryItemsContainer()\n\t\t\t\t.find('tfoot .wisableTd')\n\t\t\t\t.each(function(index) {\n\t\t\t\t\tthisInstance.calculatSummary($(this), $(this).data('sumfield'));\n\t\t\t\t});\n\t\t\tthisInstance.calculatDiscountSummary();\n\t\t\tthisInstance.calculatTaxSummary();\n\t\t\tthisInstance.calculatCurrenciesSummary();\n\t\t\tthisInstance.calculatMarginPSummary();\n\t\t},\n\t\tcalculatSummary: function(element, field) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar sum = 0;\n\t\t\tthis.getInventoryItemsContainer()\n\t\t\t\t.find(thisInstance.rowClass)\n\t\t\t\t.each(function(index) {\n\t\t\t\t\tvar element = $(this).find('.' + field);\n\t\t\t\t\tif (element.length > 0) {\n\t\t\t\t\t\tsum += App.Fields.Double.formatToDb(element.val());\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\telement.text(App.Fields.Double.formatToDisplay(sum));\n\t\t},\n\t\tcalculatMarginPSummary: function() {\n\t\t\tlet sumRow = this.getInventoryItemsContainer().find('tfoot'),\n\t\t\t\ttotalPriceField =\n\t\t\t\t\tsumRow.find('[data-sumfield=\"netPrice\"]').length > 0\n\t\t\t\t\t\t? sumRow.find('[data-sumfield=\"netPrice\"]')\n\t\t\t\t\t\t: sumRow.find('[data-sumfield=\"totalPrice\"]'),\n\t\t\t\tsumPrice = totalPriceField.getNumberFromText(),\n\t\t\t\tpurchase = 0,\n\t\t\t\tmarginp = 0;\n\t\t\tthis.getInventoryItemsContainer()\n\t\t\t\t.find(this.rowClass)\n\t\t\t\t.each(function(index) {\n\t\t\t\t\tlet qty = $(this)\n\t\t\t\t\t\t\t.find('.qty')\n\t\t\t\t\t\t\t.getNumberFromValue(),\n\t\t\t\t\t\tpurchasePrice = $(this)\n\t\t\t\t\t\t\t.find('.purchase')\n\t\t\t\t\t\t\t.getNumberFromValue();\n\t\t\t\t\tif (qty > 0 && purchasePrice > 0) {\n\t\t\t\t\t\tpurchase += qty * purchasePrice;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\tlet subtraction = sumPrice - purchase;\n\t\t\tif (purchase !== 0 && sumPrice !== 0) {\n\t\t\t\tmarginp = (subtraction / sumPrice) * 100;\n\t\t\t}\n\t\t\tsumRow.find('[data-sumfield=\"marginP\"]').text(App.Fields.Double.formatToDisplay(marginp) + '%');\n\t\t},\n\t\tcalculatDiscountSummary: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar discount = thisInstance.getAllDiscount();\n\t\t\tvar container = thisInstance.getInventorySummaryDiscountContainer();\n\t\t\tcontainer.find('input').val(App.Fields.Double.formatToDisplay(discount));\n\t\t},\n\t\tgetAllDiscount: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar discount = 0;\n\t\t\tthis.getInventoryItemsContainer()\n\t\t\t\t.find(thisInstance.rowClass)\n\t\t\t\t.each(function(index) {\n\t\t\t\t\tvar row = $(this);\n\t\t\t\t\tdiscount += thisInstance.getDiscount(row);\n\t\t\t\t});\n\t\t\treturn discount;\n\t\t},\n\t\tcalculatCurrenciesSummary: function() {\n\t\t\tlet container = this.getInventorySummaryCurrenciesContainer(),\n\t\t\t\tselected = $('.js-currency option:selected', this.getInventoryHeadContainer()),\n\t\t\t\tbase = $('.js-currency option[data-base-currency=\"1\"]', this.getInventoryHeadContainer()),\n\t\t\t\tconversionRate = selected.data('conversionRate'),\n\t\t\t\tbaseConversionRate = base.data('conversionRate');\n\t\t\tif (conversionRate == baseConversionRate) {\n\t\t\t\tcontainer.addClass('d-none');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconversionRate = parseFloat(baseConversionRate) / parseFloat(conversionRate);\n\t\t\tcontainer.removeClass('d-none');\n\t\t\tvar taxes = this.getAllTaxes();\n\t\t\tvar sum = 0;\n\t\t\tcontainer.find('.js-panel__body').html('');\n\t\t\t$.each(taxes, function(index, value) {\n\t\t\t\tif (value != undefined) {\n\t\t\t\t\tvalue = value * conversionRate;\n\t\t\t\t\tvar row = container.find('.d-none .form-group').clone();\n\t\t\t\t\trow.find('.percent').text(index + '%');\n\t\t\t\t\trow.find('input').val(App.Fields.Double.formatToDisplay(value));\n\t\t\t\t\trow.appendTo(container.find('.js-panel__body'));\n\t\t\t\t\tsum += value;\n\t\t\t\t}\n\t\t\t});\n\t\t\tcontainer.find('.js-panel__footer input').val(App.Fields.Double.formatToDisplay(sum));\n\t\t},\n\t\tcalculatTaxSummary: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar taxes = thisInstance.getAllTaxes();\n\t\t\tvar container = thisInstance.getInventorySummaryTaxesContainer();\n\t\t\tcontainer.find('.js-panel__body').html('');\n\t\t\tvar sum = 0;\n\t\t\tfor (var index in taxes) {\n\t\t\t\tvar row = container.find('.d-none .form-group').clone();\n\t\t\t\trow.find('.percent').text(App.Fields.Double.formatToDisplay(index) + '%');\n\t\t\t\trow.find('input').val(App.Fields.Double.formatToDisplay(taxes[index]));\n\t\t\t\trow.appendTo(container.find('.js-panel__body'));\n\t\t\t\tsum += taxes[index];\n\t\t\t}\n\t\t\tcontainer.find('.js-panel__footer input').val(App.Fields.Double.formatToDisplay(sum));\n\t\t},\n\t\tgetAllTaxes: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar tax = [];\n\t\t\tvar typeSummary = $('.aggregationTypeTax').val();\n\t\t\tthis.getInventoryItemsContainer()\n\t\t\t\t.find(thisInstance.rowClass)\n\t\t\t\t.each(function(index) {\n\t\t\t\t\tvar row = $(this);\n\t\t\t\t\tvar netPrice = thisInstance.getNetPrice(row);\n\t\t\t\t\tvar params = row.find('.taxParam').val();\n\t\t\t\t\tif (params != '' && params != '[]' && params != undefined) {\n\t\t\t\t\t\tvar param = JSON.parse(params);\n\t\t\t\t\t\tif (typeof param.aggregationType == 'string') {\n\t\t\t\t\t\t\tparam.aggregationType = [param.aggregationType];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (param.aggregationType)\n\t\t\t\t\t\t\t$.each(param.aggregationType, function(index, name) {\n\t\t\t\t\t\t\t\tname = name + 'Tax';\n\t\t\t\t\t\t\t\tif (param[name] == undefined) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvar percent = parseFloat(param[name]);\n\t\t\t\t\t\t\t\tvar old = 0;\n\t\t\t\t\t\t\t\tif (tax[percent] != undefined) {\n\t\t\t\t\t\t\t\t\told = parseFloat(tax[percent]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvar taxRate = netPrice * (percent / 100);\n\t\t\t\t\t\t\t\ttax[percent] = old + taxRate;\n\t\t\t\t\t\t\t\tif (typeSummary == '2') {\n\t\t\t\t\t\t\t\t\tnetPrice += taxRate;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\treturn tax;\n\t\t},\n\t\tcalculateNetPrice: function(row) {\n\t\t\tthis.setNetPrice(row, this.getNetPrice(row));\n\t\t},\n\t\tcalculateGrossPrice: function(row) {\n\t\t\tvar netPrice = this.getNetPrice(row);\n\t\t\tif (this.isIndividualTaxMode(row) || this.isGroupTaxMode(row)) {\n\t\t\t\tnetPrice += this.getTax(row);\n\t\t\t}\n\t\t\tthis.setGrossPrice(row, netPrice);\n\t\t},\n\t\tcalculateTotalPrice: function(row) {\n\t\t\tthis.setTotalPrice(row, this.getTotalPrice(row));\n\t\t},\n\t\tcalculateMargin: function(row) {\n\t\t\tvar netPrice;\n\t\t\tif ($('.netPrice', row).length) {\n\t\t\t\tnetPrice = this.getNetPrice(row);\n\t\t\t} else {\n\t\t\t\tnetPrice = this.getTotalPrice(row) - this.getDiscount(row);\n\t\t\t}\n\t\t\tvar purchase = this.getPurchase(row);\n\t\t\tvar margin = netPrice - purchase;\n\t\t\tthis.setMargin(row, margin);\n\t\t\tvar marginp = '0';\n\t\t\tif (purchase !== 0) {\n\t\t\t\tmarginp = (margin / purchase) * 100;\n\t\t\t}\n\t\t\tthis.setMarginP(row, marginp);\n\t\t},\n\t\tcalculateDiscount: function(row, modal) {\n\t\t\tvar netPriceBeforeDiscount = App.Fields.Double.formatToDb(modal.find('.valueTotalPrice').text()),\n\t\t\t\tvaluePrices = netPriceBeforeDiscount,\n\t\t\t\tglobalDiscount = 0,\n\t\t\t\tgroupDiscount = 0,\n\t\t\t\tindividualDiscount = 0,\n\t\t\t\tvalueDiscount = 0;\n\n\t\t\tvar discountsType = modal.find('.discountsType').val();\n\n\t\t\tif (discountsType == '0' || discountsType == '1') {\n\t\t\t\tif (modal.find('.js-active .globalDiscount').length > 0) {\n\t\t\t\t\tglobalDiscount = App.Fields.Double.formatToDb(modal.find('.js-active .globalDiscount').val());\n\t\t\t\t}\n\t\t\t\tif (modal.find('.js-active .individualDiscountType').length > 0) {\n\t\t\t\t\tvar individualTypeDiscount = modal.find('.js-active .individualDiscountType:checked').val();\n\t\t\t\t\tvar value = App.Fields.Double.formatToDb(modal.find('.js-active .individualDiscountValue').val());\n\t\t\t\t\tif (individualTypeDiscount == 'percentage') {\n\t\t\t\t\t\tindividualDiscount = netPriceBeforeDiscount * (value / 100);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tindividualDiscount = value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (\n\t\t\t\t\tmodal.find('.js-active .groupCheckbox').length > 0 &&\n\t\t\t\t\tmodal.find('.js-active .groupCheckbox').prop('checked') == true\n\t\t\t\t) {\n\t\t\t\t\tgroupDiscount = App.Fields.Double.formatToDb(modal.find('.groupValue').val());\n\t\t\t\t\tgroupDiscount = netPriceBeforeDiscount * (groupDiscount / 100);\n\t\t\t\t}\n\n\t\t\t\tvaluePrices = valuePrices * ((100 - globalDiscount) / 100);\n\t\t\t\tvaluePrices = valuePrices - individualDiscount;\n\t\t\t\tvaluePrices = valuePrices - groupDiscount;\n\t\t\t} else if (discountsType == '2') {\n\t\t\t\tmodal.find('.js-active').each(function(index) {\n\t\t\t\t\tvar panel = $(this);\n\t\t\t\t\tif (panel.find('.globalDiscount').length > 0) {\n\t\t\t\t\t\tvar globalDiscount = App.Fields.Double.formatToDb(panel.find('.globalDiscount').val());\n\t\t\t\t\t\tvaluePrices = valuePrices * ((100 - globalDiscount) / 100);\n\t\t\t\t\t} else if (\n\t\t\t\t\t\tpanel.find('.groupCheckbox').length > 0 &&\n\t\t\t\t\t\tpanel.find('.groupCheckbox').prop('checked') == true\n\t\t\t\t\t) {\n\t\t\t\t\t\tvar groupDiscount = App.Fields.Double.formatToDb(panel.find('.groupValue').val());\n\t\t\t\t\t\tvaluePrices = valuePrices * ((100 - groupDiscount) / 100);\n\t\t\t\t\t} else if (panel.find('.individualDiscountType').length > 0) {\n\t\t\t\t\t\tvar value = App.Fields.Double.formatToDb(panel.find('.individualDiscountValue').val());\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tpanel.find('.individualDiscountType[name=\"individualDiscountType\"]:checked').val() ==\n\t\t\t\t\t\t\t'percentage'\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tvaluePrices = valuePrices * ((100 - value) / 100);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvaluePrices = valuePrices - value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tmodal.find('.valuePrices').text(App.Fields.Double.formatToDisplay(valuePrices));\n\t\t\tmodal.find('.valueDiscount').text(App.Fields.Double.formatToDisplay(netPriceBeforeDiscount - valuePrices));\n\t\t},\n\t\tcalculateTax: function(row, modal) {\n\t\t\tvar netPriceWithoutTax = App.Fields.Double.formatToDb(modal.find('.valueNetPrice').text()),\n\t\t\t\tvaluePrices = netPriceWithoutTax,\n\t\t\t\tglobalTax = 0,\n\t\t\t\tgroupTax = 0,\n\t\t\t\tregionalTax = 0,\n\t\t\t\tindividualTax = 0;\n\n\t\t\tvar taxType = modal.find('.taxsType').val();\n\t\t\tif (taxType == '0' || taxType == '1') {\n\t\t\t\tif (modal.find('.js-active .globalTax').length > 0) {\n\t\t\t\t\tglobalTax = App.Fields.Double.formatToDb(modal.find('.js-active .globalTax').val());\n\t\t\t\t}\n\t\t\t\tif (modal.find('.js-active .individualTaxValue').length > 0) {\n\t\t\t\t\tvar value = App.Fields.Double.formatToDb(modal.find('.js-active .individualTaxValue').val());\n\t\t\t\t\tindividualTax = (value / 100) * valuePrices;\n\t\t\t\t}\n\t\t\t\tif (modal.find('.js-active .groupTax').length > 0) {\n\t\t\t\t\tgroupTax = App.Fields.Double.formatToDb(modal.find('.groupTax').val());\n\t\t\t\t\tgroupTax = netPriceWithoutTax * (groupTax / 100);\n\t\t\t\t}\n\t\t\t\tif (modal.find('.js-active .regionalTax').length > 0) {\n\t\t\t\t\tregionalTax = App.Fields.Double.formatToDb(modal.find('.regionalTax').val());\n\t\t\t\t\tregionalTax = netPriceWithoutTax * (regionalTax / 100);\n\t\t\t\t}\n\n\t\t\t\tvaluePrices = valuePrices * ((100 + globalTax) / 100);\n\t\t\t\tvaluePrices = valuePrices + individualTax;\n\t\t\t\tvaluePrices = valuePrices + groupTax;\n\t\t\t\tvaluePrices = valuePrices + regionalTax;\n\t\t\t} else if (taxType == '2') {\n\t\t\t\tmodal.find('.js-active').each(function(index) {\n\t\t\t\t\tvar panel = $(this);\n\t\t\t\t\tif (panel.find('.globalTax').length > 0) {\n\t\t\t\t\t\tvar globalTax = App.Fields.Double.formatToDb(panel.find('.globalTax').val());\n\t\t\t\t\t\tvaluePrices = valuePrices * ((100 + globalTax) / 100);\n\t\t\t\t\t} else if (panel.find('.groupTax').length > 0) {\n\t\t\t\t\t\tvar groupTax = App.Fields.Double.formatToDb(panel.find('.groupTax').val());\n\t\t\t\t\t\tvaluePrices = valuePrices * ((100 + groupTax) / 100);\n\t\t\t\t\t} else if (panel.find('.regionalTax').length > 0) {\n\t\t\t\t\t\tvar regionalTax = App.Fields.Double.formatToDb(panel.find('.regionalTax').val());\n\t\t\t\t\t\tvaluePrices = valuePrices * ((100 + regionalTax) / 100);\n\t\t\t\t\t} else if (panel.find('.individualTaxValue').length > 0) {\n\t\t\t\t\t\tvar value = App.Fields.Double.formatToDb(panel.find('.individualTaxValue').val());\n\t\t\t\t\t\tvaluePrices = ((value + 100) / 100) * valuePrices;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (netPriceWithoutTax) {\n\t\t\t\tlet taxValue = ((valuePrices - netPriceWithoutTax) / netPriceWithoutTax) * 100;\n\t\t\t\tmodal.find('.js-tax-value').text(App.Fields.Double.formatToDisplay(taxValue));\n\t\t\t}\n\t\t\tmodal.find('.valuePrices').text(App.Fields.Double.formatToDisplay(valuePrices));\n\t\t\tmodal.find('.valueTax').text(App.Fields.Double.formatToDisplay(valuePrices - netPriceWithoutTax));\n\t\t},\n\t\tupdateRowSequence: function() {\n\t\t\tvar items = this.getInventoryItemsContainer();\n\t\t\titems.find(this.rowClass).each(function(index) {\n\t\t\t\t$(this)\n\t\t\t\t\t.find('.sequence')\n\t\t\t\t\t.val(index + 1);\n\t\t\t});\n\t\t},\n\t\tregisterInventorySaveData: function() {\n\t\t\tconst thisInstance = this;\n\t\t\tthisInstance.form.on(Vtiger_Edit_Js.recordPreSave, function(e, data) {\n\t\t\t\tthisInstance.syncHeaderData();\n\t\t\t\tif (!thisInstance.checkLimits(thisInstance.form)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tlet table = thisInstance.form.find('#blackIthemTable');\n\t\t\t\ttable.find('[name]').removeAttr('name');\n\t\t\t});\n\t\t},\n\t\tsyncHeaderData() {\n\t\t\tlet header = this.getInventoryHeadContainer();\n\t\t\tthis.getInventoryItemsContainer()\n\t\t\t\t.find('.js-sync')\n\t\t\t\t.each(function() {\n\t\t\t\t\tlet element = $(this);\n\t\t\t\t\telement.val(header.find('.js-' + element.data('syncId')).val());\n\t\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function which will be used to handle price book popup\n\t\t * @params :  element - popup image element\n\t\t */\n\t\tpricebooksModalHandler: function(element) {\n\t\t\tconst thisInstance = this;\n\t\t\tlet lineItemRow = element.closest(this.rowClass);\n\t\t\tlet rowName = lineItemRow.find('.rowName');\n\t\t\tapp.showRecordsList(\n\t\t\t\t{\n\t\t\t\t\tmodule: 'PriceBooks',\n\t\t\t\t\tsrc_module: $('[name=\"popupReferenceModule\"]', rowName).val(),\n\t\t\t\t\tsrc_record: $('.sourceField', rowName).val(),\n\t\t\t\t\tsrc_field: $('[name=\"popupReferenceModule\"]', rowName).data('field'),\n\t\t\t\t\tcurrency_id: thisInstance.getCurrency() || CONFIG.defaultCurrencyId\n\t\t\t\t},\n\t\t\t\t(modal, instance) => {\n\t\t\t\t\tinstance.setSelectEvent(responseData => {\n\t\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\t\tmodule: 'PriceBooks',\n\t\t\t\t\t\t\taction: 'ProductListPrice',\n\t\t\t\t\t\t\trecord: responseData.id,\n\t\t\t\t\t\t\tsrc_record: $('.sourceField', rowName).val()\n\t\t\t\t\t\t}).done(function(data) {\n\t\t\t\t\t\t\tif (data.result) {\n\t\t\t\t\t\t\t\tthisInstance.setUnitPrice(lineItemRow, data.result);\n\t\t\t\t\t\t\t\tthisInstance.quantityChangeActions(lineItemRow);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tapp.errorLog('Incorrect data', responseData);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\t\tsubProductsCashe: [],\n\t\tloadSubProducts: function(parentRow, indicator) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar recordId = $('input.sourceField', parentRow).val();\n\t\t\tvar recordModule = parentRow.find('.rowName input[name=\"popupReferenceModule\"]').val();\n\t\t\tthisInstance.removeSubProducts(parentRow);\n\t\t\tif (recordId == '0' || recordId == '' || $.inArray(recordModule, ['Products', 'Services']) < 0) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (thisInstance.subProductsCashe[recordId]) {\n\t\t\t\tthisInstance.addSubProducts(parentRow, thisInstance.subProductsCashe[recordId]);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar subProrductParams = {\n\t\t\t\tmodule: 'Products',\n\t\t\t\taction: 'SubProducts',\n\t\t\t\trecord: recordId\n\t\t\t};\n\t\t\tif (indicator) {\n\t\t\t\tvar progressInstace = $.progressIndicator();\n\t\t\t}\n\t\t\tAppConnector.request(subProrductParams)\n\t\t\t\t.done(function(data) {\n\t\t\t\t\tvar responseData = data.result;\n\t\t\t\t\tthisInstance.subProductsCashe[recordId] = responseData;\n\t\t\t\t\tthisInstance.addSubProducts(parentRow, responseData);\n\t\t\t\t\tif (progressInstace) {\n\t\t\t\t\t\tprogressInstace.hide();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.fail(function(error, err) {\n\t\t\t\t\tif (progressInstace) {\n\t\t\t\t\t\tprogressInstace.hide();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t},\n\t\tremoveSubProducts: function(parentRow) {\n\t\t\tvar subProductsContainer = $('.subProductsContainer ul', parentRow);\n\t\t\tsubProductsContainer.find('li').remove();\n\t\t},\n\t\taddSubProducts: function(parentRow, responseData) {\n\t\t\tvar subProductsContainer = $('.subProductsContainer ul', parentRow);\n\t\t\tfor (var id in responseData) {\n\t\t\t\tvar priductText = $('<li>').text(responseData[id]);\n\t\t\t\tsubProductsContainer.append(priductText);\n\t\t\t}\n\t\t},\n\t\tmapResultsToFields: function(referenceModule, parentRow, responseData) {\n\t\t\tlet unit,\n\t\t\t\tunitPrice,\n\t\t\t\ttaxParam = [];\n\t\t\tvar thisInstance = this;\n\t\t\tvar isGroupTax = thisInstance.isGroupTaxMode();\n\t\t\tfor (var id in responseData) {\n\t\t\t\tvar recordData = responseData[id];\n\t\t\t\tvar description = recordData.description;\n\t\t\t\tvar unitPriceValues = recordData.unitPriceValues;\n\t\t\t\tvar unitPriceValuesJson = JSON.stringify(unitPriceValues);\n\t\t\t\t// Load taxes detail\n\t\t\t\tif (isGroupTax) {\n\t\t\t\t\tvar parameters = parentRow.closest('.inventoryItems').data('taxParam');\n\t\t\t\t\tif (parameters) {\n\t\t\t\t\t\ttaxParam = JSON.parse(parameters);\n\t\t\t\t\t}\n\t\t\t\t} else if (recordData['taxes']) {\n\t\t\t\t\ttaxParam = { aggregationType: recordData.taxes.type };\n\t\t\t\t\ttaxParam[recordData.taxes.type + 'Tax'] = recordData.taxes.value;\n\t\t\t\t}\n\t\t\t\tif (recordData['taxes']) {\n\t\t\t\t\tparentRow.find('.js-tax').attr('data-default-tax', recordData.taxes.value);\n\t\t\t\t}\n\t\t\t\tthisInstance.setPurchase(parentRow, recordData.purchase);\n\t\t\t\tthisInstance.setTaxParam(parentRow, taxParam);\n\t\t\t\tthisInstance.setTax(parentRow, 0);\n\t\t\t\tthisInstance.setTaxPercent(parentRow, 0);\n\t\t\t\t// Load auto fields\n\t\t\t\tfor (var field in recordData['autoFields']) {\n\t\t\t\t\tparentRow.find('input.' + field).val(recordData['autoFields'][field]);\n\t\t\t\t\tif (recordData['autoFields'][field + 'Text']) {\n\t\t\t\t\t\tparentRow.find('.' + field + 'Text').text(recordData['autoFields'][field + 'Text']);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (recordData.price !== undefined) {\n\t\t\t\t\tthisInstance.setUnitPrice(parentRow, recordData.price);\n\t\t\t\t}\n\t\t\t\tif (unitPriceValuesJson !== undefined) {\n\t\t\t\t\t$('input.unitPrice', parentRow).attr('list-info', unitPriceValuesJson);\n\t\t\t\t}\n\t\t\t\tvar commentElement = $('textarea.commentTextarea', parentRow.next());\n\t\t\t\tvar editorInstance = CKEDITOR.instances[commentElement.attr('id')];\n\t\t\t\tif (editorInstance) {\n\t\t\t\t\teditorInstance.setData(description);\n\t\t\t\t} else {\n\t\t\t\t\tcommentElement.val(description);\n\t\t\t\t}\n\t\t\t\tif (typeof recordData['autoFields']['unit'] !== 'undefined') {\n\t\t\t\t\tunit = recordData['autoFields']['unit'];\n\t\t\t\t}\n\t\t\t\tthis.triggerQtyParam(unit, recordData.qtyPerUnit, parentRow);\n\t\t\t}\n\t\t\tif (referenceModule === 'Products') {\n\t\t\t\tthisInstance.loadSubProducts(parentRow, true);\n\t\t\t}\n\t\t\tthisInstance.quantityChangeActions(parentRow);\n\t\t},\n\t\t/**\n\t\t * Update qtyparam\n\t\t * @param {null|string} unit\n\t\t * @param int perUnit\n\t\t * @param {jQuery} parentRow\n\t\t */\n\t\ttriggerQtyParam(unit, perUnit, parentRow) {\n\t\t\tlet validationEngine;\n\t\t\tswitch (unit) {\n\t\t\t\tdefault:\n\t\t\t\t\t$('.qtyParamInfo', parentRow).addClass('d-none');\n\t\t\t\t\tvalidationEngine =\n\t\t\t\t\t\t'validate[required,funcCall[Vtiger_NumberUserFormat_Validator_Js.invokeValidation]]';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'pack':\n\t\t\t\t\t$('.qtyParamInfo', parentRow)\n\t\t\t\t\t\t.removeClass('d-none')\n\t\t\t\t\t\t.removeClass('active');\n\t\t\t\t\t$('.qtyParamInfo', parentRow).attr('data-content', perUnit);\n\t\t\t\t\tvalidationEngine = 'validate[required,funcCall[Vtiger_WholeNumber_Validator_Js.invokeValidation]]';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'pcs':\n\t\t\t\t\t$('.qtyParamInfo', parentRow).addClass('d-none');\n\t\t\t\t\tvalidationEngine = 'validate[required,funcCall[Vtiger_WholeNumber_Validator_Js.invokeValidation]]';\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t$('input.qty', parentRow).attr('data-validation-engine', validationEngine);\n\t\t},\n\t\tsaveDiscountsParameters: function(parentRow, modal) {\n\t\t\tvar thisInstance = this;\n\t\t\tlet info = {};\n\t\t\tlet typeName = 'aggregationType';\n\t\t\tlet panels = modal.find('[name=\"' + typeName + '\"]:checked');\n\t\t\tinfo[typeName] = [];\n\t\t\tpanels.each(function(i) {\n\t\t\t\tlet type = $(this).val(),\n\t\t\t\t\tcontainer = $(this).closest('.js-panel');\n\t\t\t\tif (panels.length > 1) {\n\t\t\t\t\tinfo[typeName].push(type);\n\t\t\t\t} else {\n\t\t\t\t\tinfo[typeName] = type;\n\t\t\t\t}\n\t\t\t\tcontainer.find('[name=\"' + type + 'Discount\"]').each(function() {\n\t\t\t\t\tlet param = type + 'Discount';\n\t\t\t\t\tlet element = $(this);\n\t\t\t\t\tif ('global' === type) {\n\t\t\t\t\t\tinfo[param] = App.Fields.Double.formatToDb(element.val());\n\t\t\t\t\t} else if (\n\t\t\t\t\t\t'group' === type &&\n\t\t\t\t\t\telement\n\t\t\t\t\t\t\t.closest('.input-group')\n\t\t\t\t\t\t\t.find('.groupCheckbox')\n\t\t\t\t\t\t\t.prop('checked')\n\t\t\t\t\t) {\n\t\t\t\t\t\tinfo[param] = App.Fields.Double.formatToDb(element.val());\n\t\t\t\t\t} else if ('individual' === type) {\n\t\t\t\t\t\tlet name = 'individualDiscountType';\n\t\t\t\t\t\tinfo[name] = container.find('[name=\"' + name + '\"]:checked').val();\n\t\t\t\t\t\tinfo[param] = App.Fields.Double.formatToDb(element.val());\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\tthisInstance.setDiscountParam($('#blackIthemTable'), info);\n\t\t\tthisInstance.setDiscountParam(parentRow, info);\n\t\t},\n\t\tsaveTaxsParameters: function(parentRow, modal) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar info = {};\n\t\t\tvar extend = ['aggregationType', 'groupCheckbox', 'individualTaxType'];\n\t\t\t$.each(thisInstance.taxModalFields, function(index, param) {\n\t\t\t\tif ($.inArray(param, extend) >= 0) {\n\t\t\t\t\tif (modal.find('[name=\"' + param + '\"]:checked').length > 1) {\n\t\t\t\t\t\tinfo[param] = [];\n\t\t\t\t\t\tmodal.find('[name=\"' + param + '\"]:checked').each(function(index) {\n\t\t\t\t\t\t\tinfo[param].push($(this).val());\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tinfo[param] = modal.find('[name=\"' + param + '\"]:checked').val();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tinfo[param] = App.Fields.Double.formatToDb(modal.find('[name=\"' + param + '\"]').val());\n\t\t\t\t}\n\t\t\t});\n\t\t\tparentRow.data('taxParam', JSON.stringify(info));\n\t\t\tthisInstance.setTaxParam(parentRow, info);\n\t\t\tthisInstance.setTaxParam($('#blackIthemTable'), info);\n\t\t},\n\t\tshowExpandedRow: function(row) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar items = thisInstance.getInventoryItemsContainer();\n\t\t\tvar inventoryRowExpanded = items.find('[numrowex=\"' + row.attr('numrow') + '\"]');\n\t\t\tvar element = row.find('.toggleVisibility');\n\t\t\telement.data('status', '1');\n\t\t\tinventoryRowExpanded.removeClass('d-none');\n\t\t\tvar listInstance = Vtiger_Edit_Js.getInstance();\n\t\t\t$.each(inventoryRowExpanded.find('.js-editor'), function(key, data) {\n\t\t\t\tlistInstance.loadEditorElement($(data));\n\t\t\t});\n\t\t},\n\t\thideExpandedRow: function(row) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar items = thisInstance.getInventoryItemsContainer();\n\t\t\tvar inventoryRowExpanded = items.find('[numrowex=\"' + row.attr('numrow') + '\"]');\n\t\t\tvar element = row.find('.toggleVisibility');\n\t\t\telement.data('status', '0');\n\t\t\tinventoryRowExpanded.addClass('d-none');\n\t\t\t$.each(inventoryRowExpanded.find('.js-editor'), function(key, data) {\n\t\t\t\tvar editorInstance = CKEDITOR.instances[$(data).attr('id')];\n\t\t\t\tif (editorInstance) {\n\t\t\t\t\teditorInstance.destroy();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tinitDiscountsParameters: function(parentRow, modal) {\n\t\t\tvar thisInstance = this;\n\t\t\tvar parameters = parentRow.find('.discountParam').val();\n\t\t\tif (parameters == '' || parameters == undefined) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tparameters = JSON.parse(parameters);\n\t\t\t$.each(thisInstance.discountModalFields, function(index, param) {\n\t\t\t\tlet parameter = parameters[param];\n\t\t\t\tlet field = modal.find('[name=\"' + param + '\"]');\n\t\t\t\tif (field.attr('type') == 'checkbox' || field.attr('type') == 'radio') {\n\t\t\t\t\tif ('groupCheckbox' === param && parameters['groupDiscount'] !== undefined) {\n\t\t\t\t\t\tfield.prop('checked', true);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\tvar array = parameter;\n\t\t\t\t\tif (!$.isArray(array)) {\n\t\t\t\t\t\tarray = [array];\n\t\t\t\t\t}\n\t\t\t\t\t$.each(array, function(index, arrayValue) {\n\t\t\t\t\t\tvar value = field.filter('[value=\"' + arrayValue + '\"]').prop('checked', true);\n\t\t\t\t\t\tif (param == 'aggregationType') {\n\t\t\t\t\t\t\tvalue\n\t\t\t\t\t\t\t\t.closest('.js-panel')\n\t\t\t\t\t\t\t\t.find('.js-panel__body')\n\t\t\t\t\t\t\t\t.removeClass('d-none');\n\t\t\t\t\t\t\tvalue.closest('.js-panel').addClass('js-active');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else if (field.prop('tagName') == 'SELECT') {\n\t\t\t\t\tfield\n\t\t\t\t\t\t.find('option[value=\"' + parameter + '\"]')\n\t\t\t\t\t\t.prop('selected', 'selected')\n\t\t\t\t\t\t.change();\n\t\t\t\t} else if (!field.prop('readonly')) {\n\t\t\t\t\tfield.val(parameter);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthisInstance.calculateDiscount(parentRow, modal);\n\t\t},\n\t\tinitTaxParameters: function(parentRow, modal) {\n\t\t\tconst thisInstance = this;\n\t\t\tlet parameters;\n\t\t\tif (parentRow.data('taxParam')) {\n\t\t\t\tparameters = parentRow.data('taxParam');\n\t\t\t} else {\n\t\t\t\tparameters = parentRow.find('.taxParam').val();\n\t\t\t}\n\t\t\tif (!parameters) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tparameters = JSON.parse(parameters.toString());\n\t\t\t$.each(thisInstance.taxModalFields, function(index, param) {\n\t\t\t\tlet parameter = parameters[param],\n\t\t\t\t\tfield = modal.find('[name=\"' + param + '\"]');\n\n\t\t\t\tif (field.attr('type') === 'checkbox' || field.attr('type') === 'radio') {\n\t\t\t\t\tlet array = parameter,\n\t\t\t\t\t\tvalue;\n\t\t\t\t\tif (!$.isArray(array)) {\n\t\t\t\t\t\tarray = [array];\n\t\t\t\t\t}\n\t\t\t\t\t$.each(array, function(index, arrayValue) {\n\t\t\t\t\t\tvalue = field.filter('[value=\"' + arrayValue + '\"]').prop('checked', true);\n\t\t\t\t\t\tif (param === 'aggregationType') {\n\t\t\t\t\t\t\tvalue\n\t\t\t\t\t\t\t\t.closest('.js-panel')\n\t\t\t\t\t\t\t\t.find('.js-panel__body')\n\t\t\t\t\t\t\t\t.removeClass('d-none');\n\t\t\t\t\t\t\tvalue.closest('.js-panel').addClass('js-active');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else if (field.prop('tagName') === 'SELECT') {\n\t\t\t\t\tfield\n\t\t\t\t\t\t.find('option[value=\"' + parameter + '\"]')\n\t\t\t\t\t\t.prop('selected', 'selected')\n\t\t\t\t\t\t.change();\n\t\t\t\t} else {\n\t\t\t\t\tlet input = modal.find('[name=\"' + param + '\"]');\n\t\t\t\t\tinput.val(App.Fields.Double.formatToDisplay(parameter));\n\t\t\t\t\tif (param === 'individualTax') {\n\t\t\t\t\t\tinput.formatNumber();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tthisInstance.calculateTax(parentRow, modal);\n\t\t},\n\t\tlimitEnableSave: false,\n\t\tcheckLimits: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar account = thisInstance.getAccountId();\n\t\t\tvar limit = parseInt(app.getMainParams('inventoryLimit'));\n\t\t\tvar response = true;\n\n\t\t\tif (account == '' || thisInstance.limitEnableSave || !limit) {\n\t\t\t\treturn response;\n\t\t\t}\n\n\t\t\tvar params = {};\n\t\t\tparams.data = {\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\taction: 'Inventory',\n\t\t\t\tmode: 'checkLimits',\n\t\t\t\trecord: account,\n\t\t\t\tcurrency: thisInstance.getCurrency(),\n\t\t\t\tprice: thisInstance.getSummaryGrossPrice()\n\t\t\t};\n\t\t\tparams.async = false;\n\t\t\tparams.dataType = 'json';\n\t\t\tvar progressInstace = $.progressIndicator();\n\t\t\tAppConnector.request(params)\n\t\t\t\t.done(function(data) {\n\t\t\t\t\tprogressInstace.hide();\n\t\t\t\t\tif (data.result.status == false) {\n\t\t\t\t\t\tapp.showModalWindow(data.result.html, function(data) {});\n\t\t\t\t\t\tresponse = false;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.fail(function(error, err) {\n\t\t\t\t\tprogressInstace.hide();\n\t\t\t\t});\n\t\t\treturn response;\n\t\t},\n\t\tcurrencyChangeActions: function(select, option) {\n\t\t\tif (option.data('baseCurrency') !== select.val()) {\n\t\t\t\tthis.showCurrencyChangeModal(select, option);\n\t\t\t} else {\n\t\t\t\tthis.currencyConvertValues(select, option);\n\t\t\t\tselect.data('oldValue', select.val());\n\t\t\t}\n\t\t},\n\t\tshowCurrencyChangeModal: function(select, option) {\n\t\t\tvar thisInstance = this;\n\t\t\tif (thisInstance.lockCurrencyChange == true) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthisInstance.lockCurrencyChange = true;\n\t\t\tvar block = select.closest('th');\n\t\t\tvar modal = block.find('.modelContainer').clone();\n\t\t\tapp.showModalWindow(modal, function(data) {\n\t\t\t\tvar modal = $(data);\n\t\t\t\tvar currencyParam = JSON.parse(block.find('.js-currencyparam').val());\n\n\t\t\t\tif (currencyParam != false) {\n\t\t\t\t\tif (typeof currencyParam[option.val()] === 'undefined') {\n\t\t\t\t\t\tvar defaultCurrencyParams = {\n\t\t\t\t\t\t\tvalue: 1,\n\t\t\t\t\t\t\tdate: ''\n\t\t\t\t\t\t};\n\t\t\t\t\t\tcurrencyParam[option.val()] = defaultCurrencyParams;\n\t\t\t\t\t}\n\t\t\t\t\tmodal.find('.currencyName').text(option.text());\n\t\t\t\t\tmodal.find('.currencyRate').val(currencyParam[option.val()]['value']);\n\t\t\t\t\tmodal.find('.currencyDate').text(currencyParam[option.val()]['date']);\n\t\t\t\t}\n\t\t\t\tmodal\n\t\t\t\t\t.on('click', 'button[type=\"submit\"]', function(e) {\n\t\t\t\t\t\tvar rate = modal.find('.currencyRate').val();\n\t\t\t\t\t\tvar value = App.Fields.Double.formatToDb(rate);\n\t\t\t\t\t\tvar conversionRate = 1 / App.Fields.Double.formatToDb(rate);\n\n\t\t\t\t\t\toption.data('conversionRate', conversionRate);\n\t\t\t\t\t\tcurrencyParam[option.val()] = {\n\t\t\t\t\t\t\tdate: option.data('conversionDate'),\n\t\t\t\t\t\t\tvalue: value.toString(),\n\t\t\t\t\t\t\tconversion: conversionRate.toString()\n\t\t\t\t\t\t};\n\t\t\t\t\t\tblock.find('.js-currencyparam').val(JSON.stringify(currencyParam));\n\n\t\t\t\t\t\tthisInstance.currencyConvertValues(select, option);\n\t\t\t\t\t\tselect.data('oldValue', select.val());\n\t\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\t\tthisInstance.lockCurrencyChange = false;\n\t\t\t\t\t})\n\t\t\t\t\t.one('hidden.bs.modal', function() {\n\t\t\t\t\t\tselect.val(select.data('oldValue')).change();\n\t\t\t\t\t\tthisInstance.lockCurrencyChange = false;\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tcurrencyConvertValues: function(select, selected) {\n\t\t\tvar thisInstance = this;\n\n\t\t\tvar previous = select.find('option[value=\"' + select.data('oldValue') + '\"]');\n\t\t\tvar conversionRate = selected.data('conversionRate');\n\t\t\tvar prevConversionRate = previous.data('conversionRate');\n\t\t\tconversionRate = parseFloat(conversionRate) / parseFloat(prevConversionRate);\n\n\t\t\tthis.getInventoryItemsContainer()\n\t\t\t\t.find(thisInstance.rowClass)\n\t\t\t\t.each(function(index) {\n\t\t\t\t\tvar row = $(this);\n\n\t\t\t\t\tthisInstance.setUnitPrice(\n\t\t\t\t\t\trow,\n\t\t\t\t\t\tApp.Fields.Double.formatToDb(thisInstance.getUnitPriceValue(row) * conversionRate)\n\t\t\t\t\t);\n\t\t\t\t\tthisInstance.setDiscount(\n\t\t\t\t\t\trow,\n\t\t\t\t\t\tApp.Fields.Double.formatToDb(thisInstance.getDiscount(row) * conversionRate)\n\t\t\t\t\t);\n\t\t\t\t\tthisInstance.setTax(row, App.Fields.Double.formatToDb(thisInstance.getTax(row) * conversionRate));\n\t\t\t\t\tthisInstance.quantityChangeActions(row);\n\t\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Set up all row data that comes from request\n\t\t * @param {jQuery} row\n\t\t * @param {object} rowData\n\t\t */\n\t\tsetRowData(row, rowData) {\n\t\t\tthis.setName(row, rowData.name, rowData.info.name);\n\t\t\tthis.setQuantity(row, App.Fields.Double.formatToDisplay(rowData.qty));\n\t\t\tthis.setUnit(row, rowData.info.autoFields.unit, rowData.info.autoFields.unitText);\n\t\t\tif (\n\t\t\t\ttypeof rowData.info.autoFields !== 'undefined' &&\n\t\t\t\ttypeof rowData.info.autoFields.subunit !== 'undefined'\n\t\t\t) {\n\t\t\t\tthis.setSubUnit(row, rowData.info.autoFields.subunit, rowData.info.autoFields.subunitText);\n\t\t\t}\n\t\t\tthis.setComment(row, rowData.comment1);\n\t\t\tthis.setUnitPrice(row, App.Fields.Double.formatToDisplay(rowData.price));\n\t\t\tthis.setNetPrice(row, App.Fields.Double.formatToDisplay(rowData.net));\n\t\t\tthis.setGrossPrice(row, App.Fields.Double.formatToDisplay(rowData.gross));\n\t\t\tthis.setTotalPrice(row, App.Fields.Double.formatToDisplay(rowData.total));\n\t\t\tlet discountParam = rowData.discountparam || null;\n\t\t\tthis.setDiscountParam(row, JSON.parse(discountParam));\n\t\t\tthis.setDiscount(row, App.Fields.Double.formatToDisplay(rowData.discount));\n\t\t\tthis.setTaxParam(row, JSON.parse(rowData.taxparam));\n\t\t\tthis.setTax(row, App.Fields.Double.formatToDisplay(rowData.tax));\n\t\t\tthis.setTaxPercent(row, App.Fields.Double.formatToDisplay(rowData.tax_percent));\n\t\t},\n\t\t/**\n\t\t * Add new row to inventory list\n\t\t * @param {string} module\n\t\t * @param {string} baseTableId\n\t\t * @param {object} rowData [optional]\n\t\t */\n\t\taddItem(module, baseTableId, rowData = false) {\n\t\t\tconst items = this.getInventoryItemsContainer();\n\t\t\tlet newRow = this.getBasicRow();\n\t\t\tconst sequenceNumber = this.getNextLineItemRowNumber();\n\t\t\tconst replaced = newRow.html().replace(/\\_NUM_/g, sequenceNumber);\n\t\t\tconst moduleLbls = newRow.data('moduleLbls');\n\t\t\tnewRow.html(replaced);\n\t\t\tnewRow = newRow.children().appendTo(items.find('.js-inventory-items-body'));\n\t\t\tnewRow\n\t\t\t\t.find('.rowName input[name=\"popupReferenceModule\"]')\n\t\t\t\t.val(module)\n\t\t\t\t.data('field', baseTableId);\n\t\t\tnewRow\n\t\t\t\t.find('.js-module-icon')\n\t\t\t\t.removeClass()\n\t\t\t\t.addClass(`yfm-${module}`);\n\t\t\tnewRow.find('.rowName span.input-group-text').attr('data-content', moduleLbls[module]);\n\t\t\tnewRow.find('.colPicklistField select').each(function(index, select) {\n\t\t\t\tselect = $(select);\n\t\t\t\tselect.find('option').each(function(index, option) {\n\t\t\t\t\toption = $(option);\n\t\t\t\t\tif (option.data('module') !== module) {\n\t\t\t\t\t\toption.remove();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\tthis.initItem(newRow);\n\t\t\tVtiger_Edit_Js.getInstance().registerAutoCompleteFields(newRow);\n\t\t\tif (rowData) {\n\t\t\t\tthis.setRowData(newRow, rowData);\n\t\t\t\tthis.quantityChangeActions(newRow);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Register add item button click\n\t\t * @param {jQuery} container\n\t\t */\n\t\tregisterAddItem() {\n\t\t\tconst thisInstance = this;\n\t\t\tconst itemsHeader = thisInstance.getInventoryHeadContainer();\n\t\t\titemsHeader.find('.js-inv-add-item').on('click', function(e) {\n\t\t\t\tconst btn = $(this);\n\t\t\t\tthisInstance.addItem(btn.data('module'), btn.data('field'));\n\t\t\t});\n\t\t},\n\t\tregisterSortableItems: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar items = thisInstance.getInventoryItemsContainer();\n\t\t\titems.sortable({\n\t\t\t\thandle: '.dragHandle',\n\t\t\t\titems: thisInstance.rowClass,\n\t\t\t\trevert: true,\n\t\t\t\ttolerance: 'pointer',\n\t\t\t\tplaceholder: 'ui-state-highlight',\n\t\t\t\thelper: function(e, ui) {\n\t\t\t\t\tui.children().each(function(index, element) {\n\t\t\t\t\t\telement = $(element);\n\t\t\t\t\t\telement.width(element.width());\n\t\t\t\t\t});\n\t\t\t\t\treturn ui;\n\t\t\t\t},\n\t\t\t\tstart: function(event, ui) {\n\t\t\t\t\titems.find(thisInstance.rowClass).each(function(index, element) {\n\t\t\t\t\t\tvar row = $(element);\n\t\t\t\t\t\tthisInstance.hideExpandedRow(row);\n\t\t\t\t\t});\n\t\t\t\t\tui.item.startPos = ui.item.index();\n\t\t\t\t},\n\t\t\t\tstop: function(event, ui) {\n\t\t\t\t\tvar numrow = $(ui.item).attr('numrow');\n\t\t\t\t\tvar child = items\n\t\t\t\t\t\t.find('.numRow' + numrow)\n\t\t\t\t\t\t.remove()\n\t\t\t\t\t\t.clone();\n\t\t\t\t\titems.find('[numrow=\"' + numrow + '\"]').after(child);\n\t\t\t\t\tif (ui.item.startPos < ui.item.index()) {\n\t\t\t\t\t\tchild = items\n\t\t\t\t\t\t\t.find('.numRow' + numrow)\n\t\t\t\t\t\t\t.next()\n\t\t\t\t\t\t\t.remove()\n\t\t\t\t\t\t\t.clone();\n\t\t\t\t\t\titems.find('[numrow=\"' + numrow + '\"]').before(child);\n\t\t\t\t\t}\n\t\t\t\t\tthisInstance.updateRowSequence();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tregisterShowHideExpanded: function() {\n\t\t\tconst thisInstance = this;\n\t\t\tthisInstance.form.on('click', '.toggleVisibility', function(e) {\n\t\t\t\tvar element = $(e.currentTarget);\n\t\t\t\tvar row = thisInstance.getClosestRow(element);\n\t\t\t\tif (element.data('status') == 0) {\n\t\t\t\t\tthisInstance.showExpandedRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tthisInstance.hideExpandedRow(row);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tregisterPriceBookModal: function(container) {\n\t\t\tvar thisInstance = this;\n\t\t\tcontainer.find('.js-price-book-modal').on('click', function(e) {\n\t\t\t\tvar element = $(e.currentTarget);\n\t\t\t\tvar response = thisInstance.isRecordSelected(element);\n\t\t\t\tif (response == true) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthisInstance.pricebooksModalHandler(element);\n\t\t\t});\n\t\t},\n\t\tregisterRowChangeEvent: function(container) {\n\t\t\tcontainer.on('focusout', '.qty', e => {\n\t\t\t\tlet element = $(e.currentTarget);\n\t\t\t\telement.formatNumber();\n\t\t\t\tthis.quantityChangeActions(this.getClosestRow(element));\n\t\t\t});\n\t\t\tcontainer.on('focusout', '.unitPrice', e => {\n\t\t\t\tlet element = $(e.currentTarget);\n\t\t\t\telement.formatNumber();\n\t\t\t\tthis.quantityChangeActions(this.getClosestRow(element));\n\t\t\t});\n\t\t\tcontainer.on('focusout', '.purchase', e => {\n\t\t\t\tlet element = $(e.currentTarget);\n\t\t\t\telement.formatNumber();\n\t\t\t\tthis.quantityChangeActions(this.getClosestRow(element));\n\t\t\t});\n\t\t\tvar headContainer = this.getInventoryHeadContainer();\n\t\t\theadContainer.on('change', '.js-taxmode', e => {\n\t\t\t\tlet element = $(e.currentTarget);\n\t\t\t\tthis.showIndividualTax(this.getClosestRow(element));\n\t\t\t\tthis.rowsCalculations();\n\t\t\t});\n\t\t\theadContainer.on('change', '.js-discountmode', e => {\n\t\t\t\tlet element = $(e.currentTarget);\n\t\t\t\tthis.showIndividualDiscount(this.getClosestRow(element));\n\t\t\t\tthis.rowsCalculations();\n\t\t\t});\n\t\t},\n\t\tregisterSubProducts: function() {\n\t\t\tconst thisInstance = this;\n\t\t\tthisInstance.form.find('.inventoryItems ' + thisInstance.rowClass).each(function(index) {\n\t\t\t\tthisInstance.loadSubProducts($(this), false);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Register clear reference selection\n\t\t */\n\t\tregisterClearReferenceSelection() {\n\t\t\tthis.form.on('click', '.clearReferenceSelection', e => {\n\t\t\t\tconst referenceGroup = $(e.currentTarget).closest('div.referenceGroup');\n\t\t\t\tif (referenceGroup.length) {\n\t\t\t\t\treferenceGroup\n\t\t\t\t\t\t.find('input[id$=\"_display\"]')\n\t\t\t\t\t\t.val('')\n\t\t\t\t\t\t.removeAttr('readonly');\n\t\t\t\t} else {\n\t\t\t\t\tconst row = this.getClosestRow($(e.currentTarget));\n\t\t\t\t\tthis.removeSubProducts(row);\n\t\t\t\t\trow.find('.unitPrice,.tax,.discount,.margin,.purchase,.js-tax-percent').val(\n\t\t\t\t\t\tApp.Fields.Double.formatToDisplay(0)\n\t\t\t\t\t);\n\t\t\t\t\trow.find('.qty').val(1);\n\t\t\t\t\trow.find('textarea,.valueVal').val('');\n\t\t\t\t\trow.find('.valueText').text('');\n\t\t\t\t\trow.find('.qtyParamInfo').addClass('d-none');\n\t\t\t\t\trow.find('.recordLabel')\n\t\t\t\t\t\t.val('')\n\t\t\t\t\t\t.removeAttr('readonly');\n\t\t\t\t\tif (!this.isGroupTaxMode()) {\n\t\t\t\t\t\tthis.setTaxParam(row, []);\n\t\t\t\t\t}\n\t\t\t\t\tthis.quantityChangeActions(row);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tregisterDeleteLineItemEvent: function(container) {\n\t\t\tvar thisInstance = this;\n\t\t\tcontainer.on('click', '.deleteRow', function(e) {\n\t\t\t\tlet num = thisInstance.getClosestRow($(e.currentTarget)).attr('numrow');\n\t\t\t\tthisInstance\n\t\t\t\t\t.getInventoryItemsContainer()\n\t\t\t\t\t.find('[numrow=\"' + num + '\"], [numrowex=\"' + num + '\"]')\n\t\t\t\t\t.remove();\n\t\t\t\tthisInstance.checkDeleteIcon();\n\t\t\t\tthisInstance.rowsCalculations();\n\t\t\t\tif (thisInstance.getInventoryItemsContainer().find('.inventoryRow').length === 0) {\n\t\t\t\t\t$('#inventoryItemsNo').val(0);\n\t\t\t\t}\n\t\t\t\tthisInstance.updateRowSequence();\n\t\t\t});\n\t\t},\n\t\tregisterChangeDiscount: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tthisInstance.form.on('click', '.changeDiscount', function(e) {\n\t\t\t\tvar parentRow;\n\t\t\t\tvar element = $(e.currentTarget);\n\t\t\t\tvar params = {\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tview: 'Inventory',\n\t\t\t\t\tmode: 'showDiscounts',\n\t\t\t\t\tcurrency: thisInstance.getCurrency(),\n\t\t\t\t\trelatedRecord: thisInstance.getAccountId()\n\t\t\t\t};\n\t\t\t\tif (element.hasClass('groupDiscount')) {\n\t\t\t\t\tparentRow = thisInstance.getInventoryItemsContainer();\n\t\t\t\t\tif (parentRow.find('tfoot .colTotalPrice').length != 0) {\n\t\t\t\t\t\tparams.totalPrice = App.Fields.Double.formatToDb(parentRow.find('tfoot .colTotalPrice').text());\n\t\t\t\t\t} else {\n\t\t\t\t\t\tparams.totalPrice = 0;\n\t\t\t\t\t}\n\t\t\t\t\tparams.discountType = 1;\n\t\t\t\t} else {\n\t\t\t\t\tparentRow = element.closest(thisInstance.rowClass);\n\t\t\t\t\tparams.totalPrice = thisInstance.getTotalPrice(parentRow);\n\t\t\t\t\tparams.discountType = 0;\n\t\t\t\t}\n\n\t\t\t\tvar progressInstace = $.progressIndicator();\n\t\t\t\tAppConnector.request(params)\n\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\tapp.showModalWindow(data, function(data) {\n\t\t\t\t\t\t\tthisInstance.initDiscountsParameters(parentRow, $(data));\n\t\t\t\t\t\t\tthisInstance.registerChangeDiscountModal(data, parentRow, params);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tprogressInstace.hide();\n\t\t\t\t\t})\n\t\t\t\t\t.fail(function(error, err) {\n\t\t\t\t\t\tprogressInstace.hide();\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tregisterChangeDiscountModal: function(modal, parentRow, params) {\n\t\t\tvar thisInstance = this;\n\t\t\tmodal.on('change', '.individualDiscountType', function(e) {\n\t\t\t\tvar element = $(e.currentTarget);\n\t\t\t\tmodal.find('.individualDiscountContainer .input-group-text').text(element.data('symbol'));\n\t\t\t});\n\t\t\tmodal.on('change', '.activeCheckbox[name=\"aggregationType\"]', function(e) {\n\t\t\t\tvar element = $(e.currentTarget);\n\n\t\t\t\tif (element.attr('type') == 'checkbox' && this.checked) {\n\t\t\t\t\telement\n\t\t\t\t\t\t.closest('.js-panel')\n\t\t\t\t\t\t.find('.js-panel__body')\n\t\t\t\t\t\t.removeClass('d-none');\n\t\t\t\t\telement.closest('.js-panel').addClass('js-active');\n\t\t\t\t} else if (element.attr('type') == 'radio') {\n\t\t\t\t\tmodal.find('.js-panel').removeClass('js-active');\n\t\t\t\t\tmodal.find('.js-panel .js-panel__body').addClass('d-none');\n\t\t\t\t\telement\n\t\t\t\t\t\t.closest('.js-panel')\n\t\t\t\t\t\t.find('.js-panel__body')\n\t\t\t\t\t\t.removeClass('d-none');\n\t\t\t\t\telement.closest('.js-panel').addClass('js-active');\n\t\t\t\t} else {\n\t\t\t\t\telement\n\t\t\t\t\t\t.closest('.js-panel')\n\t\t\t\t\t\t.find('.js-panel__body')\n\t\t\t\t\t\t.addClass('d-none');\n\t\t\t\t\telement.closest('.js-panel').removeClass('js-active');\n\t\t\t\t}\n\t\t\t});\n\t\t\tmodal.on(\n\t\t\t\t'change',\n\t\t\t\t'.activeCheckbox, .globalDiscount,.individualDiscountValue,.individualDiscountType,.groupCheckbox',\n\t\t\t\tfunction(e) {\n\t\t\t\t\tthisInstance.calculateDiscount(parentRow, modal);\n\t\t\t\t}\n\t\t\t);\n\t\t\tmodal.on('click', '.saveDiscount', function(e) {\n\t\t\t\tthisInstance.saveDiscountsParameters(parentRow, modal);\n\t\t\t\tif (params.discountType == 0) {\n\t\t\t\t\tthisInstance.setDiscount(\n\t\t\t\t\t\tparentRow,\n\t\t\t\t\t\tApp.Fields.Double.formatToDb(modal.find('.valueDiscount').text())\n\t\t\t\t\t);\n\t\t\t\t\tthisInstance.quantityChangeActions(parentRow);\n\t\t\t\t} else {\n\t\t\t\t\tvar rate =\n\t\t\t\t\t\tApp.Fields.Double.formatToDb(modal.find('.valueDiscount').text()) /\n\t\t\t\t\t\tApp.Fields.Double.formatToDb(modal.find('.valueTotalPrice').text());\n\t\t\t\t\tparentRow.find(thisInstance.rowClass).each(function(index) {\n\t\t\t\t\t\tthisInstance.setDiscount($(this), thisInstance.getTotalPrice($(this)) * rate);\n\t\t\t\t\t\tthisInstance.quantityChangeActions($(this));\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tapp.hideModalWindow();\n\t\t\t});\n\t\t},\n\t\tregisterChangeTax: function() {\n\t\t\tconst thisInstance = this;\n\t\t\tthisInstance.form.on('click', '.changeTax', function(e) {\n\t\t\t\tvar parentRow;\n\t\t\t\tvar element = $(e.currentTarget);\n\t\t\t\tvar params = {\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\tview: 'Inventory',\n\t\t\t\t\tmode: 'showTaxes',\n\t\t\t\t\tcurrency: thisInstance.getCurrency(),\n\t\t\t\t\tsourceRecord: app.getRecordId()\n\t\t\t\t};\n\t\t\t\tif (element.hasClass('groupTax')) {\n\t\t\t\t\tparentRow = thisInstance.getInventoryItemsContainer();\n\t\t\t\t\tvar totalPrice = 0;\n\t\t\t\t\tif (parentRow.find('tfoot .colNetPrice').length > 0) {\n\t\t\t\t\t\ttotalPrice = parentRow.find('tfoot .colNetPrice').text();\n\t\t\t\t\t} else if (parentRow.find('tfoot .colTotalPrice ').length > 0) {\n\t\t\t\t\t\ttotalPrice = parentRow.find('tfoot .colTotalPrice ').text();\n\t\t\t\t\t}\n\t\t\t\t\tparams.totalPrice = App.Fields.Double.formatToDb(totalPrice);\n\t\t\t\t\tparams.taxType = 1;\n\t\t\t\t} else {\n\t\t\t\t\tparentRow = element.closest(thisInstance.rowClass);\n\t\t\t\t\tlet sourceRecord = parentRow.find('.rowName .sourceField').val();\n\t\t\t\t\tparams.totalPrice = thisInstance.getNetPrice(parentRow);\n\t\t\t\t\tparams.taxType = 0;\n\t\t\t\t\tif (sourceRecord) {\n\t\t\t\t\t\tparams.record = sourceRecord;\n\t\t\t\t\t}\n\t\t\t\t\tparams.recordModule = parentRow.find('.rowName [name=\"popupReferenceModule\"]').val();\n\t\t\t\t}\n\t\t\t\tvar progressInstace = $.progressIndicator();\n\t\t\t\tAppConnector.request(params)\n\t\t\t\t\t.done(function(data) {\n\t\t\t\t\t\tapp.showModalWindow(data, function(data) {\n\t\t\t\t\t\t\tthisInstance.initTaxParameters(parentRow, $(data));\n\t\t\t\t\t\t\tthisInstance.registerChangeTaxModal(data, parentRow, params);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tprogressInstace.hide();\n\t\t\t\t\t})\n\t\t\t\t\t.fail(function(error, err) {\n\t\t\t\t\t\tprogressInstace.hide();\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tlockCurrencyChange: false,\n\t\tregisterChangeCurrency() {\n\t\t\tthis.getInventoryHeadContainer().on('change', '.js-currency', e => {\n\t\t\t\tlet element = $(e.currentTarget),\n\t\t\t\t\tsymbol = element.find('option:selected').data('conversionSymbol');\n\t\t\t\tthis.currencyChangeActions(element, element.find('option:selected'));\n\t\t\t\tthis.form.find('.currencySymbol').text(symbol);\n\t\t\t});\n\t\t},\n\t\tregisterChangeTaxModal: function(modal, parentRow, params) {\n\t\t\tvar thisInstance = this;\n\t\t\tmodal.on('change', '.individualTaxType', function(e) {\n\t\t\t\tvar element = $(e.currentTarget);\n\t\t\t\tmodal.find('.individualTaxContainer .input-group-text').text(element.data('symbol'));\n\t\t\t});\n\t\t\tmodal.on('change', '.activeCheckbox[name=\"aggregationType\"]', function(e) {\n\t\t\t\tvar element = $(e.currentTarget);\n\n\t\t\t\tif (element.attr('type') == 'checkbox' && this.checked) {\n\t\t\t\t\telement\n\t\t\t\t\t\t.closest('.js-panel')\n\t\t\t\t\t\t.find('.js-panel__body')\n\t\t\t\t\t\t.removeClass('d-none');\n\t\t\t\t\telement.closest('.js-panel').addClass('js-active');\n\t\t\t\t} else if (element.attr('type') == 'radio') {\n\t\t\t\t\tmodal.find('.js-panel').removeClass('js-active');\n\t\t\t\t\tmodal.find('.js-panel .js-panel__body').addClass('d-none');\n\t\t\t\t\telement\n\t\t\t\t\t\t.closest('.js-panel')\n\t\t\t\t\t\t.find('.js-panel__body')\n\t\t\t\t\t\t.removeClass('d-none');\n\t\t\t\t\telement.closest('.js-panel').addClass('js-active');\n\t\t\t\t} else {\n\t\t\t\t\telement\n\t\t\t\t\t\t.closest('.js-panel')\n\t\t\t\t\t\t.find('.js-panel__body')\n\t\t\t\t\t\t.addClass('d-none');\n\t\t\t\t\telement.closest('.js-panel').removeClass('js-active');\n\t\t\t\t}\n\t\t\t});\n\t\t\tmodal.on('change', '.activeCheckbox, .globalTax, .individualTaxValue, .groupTax, .regionalTax', function(\n\t\t\t\te\n\t\t\t) {\n\t\t\t\tthisInstance.calculateTax(parentRow, modal);\n\t\t\t});\n\t\t\tmodal.on('click', '.saveTaxs', function(e) {\n\t\t\t\tthisInstance.saveTaxsParameters(parentRow, modal);\n\t\t\t\tif (params.taxType == '0') {\n\t\t\t\t\tthisInstance.setTax(parentRow, App.Fields.Double.formatToDb(modal.find('.valueTax').text()));\n\t\t\t\t\tthisInstance.setTaxPercent(\n\t\t\t\t\t\tparentRow,\n\t\t\t\t\t\tApp.Fields.Double.formatToDb(modal.find('.js-tax-value').text())\n\t\t\t\t\t);\n\t\t\t\t\tthisInstance.quantityChangeActions(parentRow);\n\t\t\t\t} else {\n\t\t\t\t\tvar rate =\n\t\t\t\t\t\tApp.Fields.Double.formatToDb(modal.find('.valueTax').text()) /\n\t\t\t\t\t\tApp.Fields.Double.formatToDb(modal.find('.valueNetPrice').text());\n\t\t\t\t\tparentRow.find(thisInstance.rowClass).each(function(index) {\n\t\t\t\t\t\tvar totalPrice;\n\t\t\t\t\t\tif ($('.netPrice', $(this)).length > 0) {\n\t\t\t\t\t\t\ttotalPrice = thisInstance.getNetPrice($(this));\n\t\t\t\t\t\t} else if ($('.totalPrice', $(this)).length > 0) {\n\t\t\t\t\t\t\ttotalPrice = thisInstance.getTotalPrice($(this));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthisInstance.setTax($(this), totalPrice * rate);\n\t\t\t\t\t\tthisInstance.setTaxPercent(\n\t\t\t\t\t\t\t$(this),\n\t\t\t\t\t\t\tApp.Fields.Double.formatToDb(modal.find('.js-tax-value').text())\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthisInstance.quantityChangeActions($(this));\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tapp.hideModalWindow();\n\t\t\t});\n\t\t},\n\t\tregisterRowAutoComplete: function(container) {\n\t\t\tconst thisInstance = this;\n\t\t\tlet sourceFieldElement = container.find('.sourceField.js-name');\n\t\t\tsourceFieldElement.on(Vtiger_Edit_Js.referenceSelectionEvent, function(e, params) {\n\t\t\t\tvar record = params.record;\n\t\t\t\tvar element = $(e.currentTarget);\n\t\t\t\tvar parentRow = element.closest(thisInstance.rowClass);\n\t\t\t\tvar selectedModule = parentRow.find('.rowName [name=\"popupReferenceModule\"]').val();\n\t\t\t\tvar dataUrl =\n\t\t\t\t\t'index.php?module=' +\n\t\t\t\t\tapp.getModuleName() +\n\t\t\t\t\t'&action=Inventory&mode=getDetails&record=' +\n\t\t\t\t\trecord +\n\t\t\t\t\t'&fieldname=' +\n\t\t\t\t\telement.data('columnname');\n\t\t\t\tif (thisInstance.getCurrency()) {\n\t\t\t\t\tdataUrl += '&currency_id=' + thisInstance.getCurrency();\n\t\t\t\t}\n\t\t\t\tAppConnector.request(dataUrl).done(function(data) {\n\t\t\t\t\tfor (var id in data) {\n\t\t\t\t\t\tif (typeof data[id] == 'object') {\n\t\t\t\t\t\t\tvar recordData = data[id];\n\t\t\t\t\t\t\tthisInstance.mapResultsToFields(selectedModule, parentRow, recordData);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tcalculateItemNumbers: function() {\n\t\t\tvar thisInstance = this;\n\t\t\tvar items = this.getInventoryItemsContainer();\n\t\t\tvar i = 1;\n\t\t\titems.find(thisInstance.rowClass).each(function(index) {\n\t\t\t\t$(this)\n\t\t\t\t\t.find('.itemNumberText')\n\t\t\t\t\t.text(i);\n\t\t\t\ti++;\n\t\t\t});\n\t\t},\n\t\tinitItem: function(container) {\n\t\t\tlet thisInstance = this;\n\t\t\tif (typeof container === 'undefined') {\n\t\t\t\tcontainer = thisInstance.getInventoryItemsContainer();\n\t\t\t}\n\t\t\tthisInstance.registerDeleteLineItemEvent(container);\n\t\t\tthisInstance.registerPriceBookModal(container);\n\t\t\tthisInstance.registerRowChangeEvent(container);\n\t\t\tthisInstance.registerRowAutoComplete(container);\n\t\t\tthisInstance.checkDeleteIcon();\n\t\t\tthisInstance.rowsCalculations();\n\t\t\tthisInstance.updateRowSequence();\n\t\t\tApp.Fields.Picklist.showSelect2ElementView(container.find('.selectInv'));\n\t\t\tApp.Fields.Date.register(container, true, {}, 'dateFieldInv');\n\t\t\tcontainer.validationEngine('detach');\n\t\t\tcontainer.validationEngine(app.validationEngineOptions);\n\t\t},\n\t\t/**\n\t\t * Load inventory data for specified record\n\t\t * @param {int} recordId\n\t\t * @param {string} sourceModule\n\t\t * @param {function|bool} success callback\n\t\t * @param {function|bool} fail callback\n\t\t * @returns Promise\n\t\t */\n\t\tloadInventoryData(recordId, sourceModule, success = false, fail = false) {\n\t\t\tconst progressLoader = $.progressIndicator({ blockInfo: { enabled: true } });\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tAppConnector.request({\n\t\t\t\t\tmodule: sourceModule,\n\t\t\t\t\taction: 'Inventory',\n\t\t\t\t\tmode: 'getTableData',\n\t\t\t\t\trecord: recordId\n\t\t\t\t})\n\t\t\t\t\t.done(response => {\n\t\t\t\t\t\tlet activeModules = [];\n\t\t\t\t\t\tthis.getInventoryHeadContainer()\n\t\t\t\t\t\t\t.find('.js-inv-add-item')\n\t\t\t\t\t\t\t.each((index, addBtn) => {\n\t\t\t\t\t\t\t\tactiveModules.push($(addBtn).data('module'));\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\tprogressLoader.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\tconst oldCurrencyChangeAction = this.currencyChangeActions;\n\t\t\t\t\t\tthis.currencyChangeActions = function changeCurrencyActions(select, option) {\n\t\t\t\t\t\t\tthis.currencyConvertValues(select, option);\n\t\t\t\t\t\t\tselect.data('oldValue', select.val());\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconst first = response.result[Object.keys(response.result)[0]];\n\t\t\t\t\t\tthis.setCurrencyParam(first.currencyparam);\n\t\t\t\t\t\tthis.setCurrency(first.currency);\n\t\t\t\t\t\tthis.setDiscountMode(first.discountmode);\n\t\t\t\t\t\tthis.setTaxMode(first.taxmode);\n\t\t\t\t\t\tthis.currencyChangeActions = oldCurrencyChangeAction;\n\t\t\t\t\t\t$.each(response.result, (index, row) => {\n\t\t\t\t\t\t\tif (activeModules.indexOf(row.moduleName) !== -1) {\n\t\t\t\t\t\t\t\tthis.addItem(row.moduleName, row.basetableid, row);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tVtiger_Helper_Js.showMessage({\n\t\t\t\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\t\t\t\ttext: app\n\t\t\t\t\t\t\t\t\t\t.vtranslate('JS_INVENTORY_ITEM_MODULE_NOT_FOUND')\n\t\t\t\t\t\t\t\t\t\t.replace('${sourceModule}', row.moduleName)\n\t\t\t\t\t\t\t\t\t\t.replace('${position}', row.info.name)\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.summaryCalculations();\n\t\t\t\t\t\tresolve(response.result);\n\t\t\t\t\t\tif (typeof success === 'function') {\n\t\t\t\t\t\t\tsuccess(response.result);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.fail((error, err) => {\n\t\t\t\t\t\tprogressLoader.progressIndicator({ mode: 'hide' });\n\t\t\t\t\t\treject(error, err);\n\t\t\t\t\t\tif (typeof fail === 'function') {\n\t\t\t\t\t\t\tfail(error, err);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * Function which will register all the events\n\t\t */\n\t\tregisterEvents: function(container) {\n\t\t\tthis.form = container;\n\t\t\tthis.registerInventorySaveData();\n\t\t\tthis.registerAddItem();\n\t\t\tthis.initItem();\n\t\t\tthis.registerSortableItems();\n\t\t\tthis.registerSubProducts();\n\t\t\tthis.registerChangeDiscount();\n\t\t\tthis.registerChangeTax();\n\t\t\tthis.registerClearReferenceSelection();\n\t\t\tthis.registerShowHideExpanded();\n\t\t\tthis.registerChangeCurrency();\n\t\t\tthis.setDefaultGlobalTax(container);\n\t\t}\n\t}\n);\n"],"names":["$","Class","inventoryInstance","getInventoryInstance","container","find","val","moduleClassName","registerEvents","form","inventoryContainer","inventoryHeadContainer","summaryTaxesContainer","summaryDiscountContainer","summaryCurrenciesContainer","rowClass","discountModalFields","taxModalFields","getForm","getInventoryItemsContainer","getInventoryHeadContainer","getInventorySummaryDiscountContainer","getInventorySummaryTaxesContainer","getInventorySummaryCurrenciesContainer","getNextLineItemRowNumber","rowNumber","parseInt","$inventoryItemsNo","getAccountId","accountReferenceField","checkDeleteIcon","length","showLineItemsDeleteIcon","app","getMainParams","hideLineItemsDeleteIcon","removeClass","addClass","getClosestRow","element","closest","getBasicRow","eq","clone","isRecordSelected","productField","parentRow","validationEngine","getTaxModeSelectElement","row","isIndividualTaxMode","selectedOption","taxModeElement","isGroupTaxMode","taxTypeElement","showIndividualTax","groupTax","thisInstance","items","newRow","taxParam","aggregationType","each","thisItem","attr","setTaxParam","setTax","setTaxPercent","setDefaultGlobalTax","rowsCalculations","taxDefaultValue","data","isGroupTax","JSON","stringify","quantityChangeActions","getDiscountModeSelectElement","isIndividualDiscountMode","discountModeElement","showIndividualDiscount","groupDiscount","setDiscount","setDiscountParam","getCurrency","getTax","taxParams","parse","valuePrices","getNetPrice","taxRate","types","forEach","entry","taxValue","individualTax","globalTax","regionalTax","getTaxPercent","taxPercent","getTaxParams","getQuantityValue","getNumberFromValue","getUnitPriceValue","getDiscount","discountParams","getTotalPrice","discountRate","discountValue","individualDiscount","individualDiscountType","globalDiscount","getGrossPrice","getPurchase","purchase","App","Fields","Double","formatToDb","qty","getSummaryGrossPrice","price","setCurrency","trigger","setCurrencyParam","setDiscountMode","setTaxMode","setName","display","setQuantity","setUnit","text","setSubUnit","setComment","parent","setUnitPrice","formatToDisplay","setPurchase","setNetPrice","setGrossPrice","setTotalPrice","setMargin","setMarginP","rowCalculations","summaryCalculations","calculateTotalPrice","calculateDiscounts","calculateNetPrice","calculateTaxes","calculateGrossPrice","calculateMargin","calculateItemNumbers","calculatSummary","calculatDiscountSummary","calculatTaxSummary","calculatCurrenciesSummary","calculatMarginPSummary","field","sum","totalPriceField","sumRow","sumPrice","getNumberFromText","marginp","purchasePrice","subtraction","discount","getAllDiscount","selected","base","conversionRate","baseConversionRate","parseFloat","getAllTaxes","html","taxes","index","value","appendTo","tax","typeSummary","netPrice","params","param","name","old","percent","margin","calculateDiscount","modal","netPriceBeforeDiscount","discountsType","prop","panel","calculateTax","netPriceWithoutTax","taxType","updateRowSequence","registerInventorySaveData","on","Vtiger_Edit_Js","recordPreSave","syncHeaderData","checkLimits","table","removeAttr","header","pricebooksModalHandler","lineItemRow","rowName","showRecordsList","module","src_module","src_record","src_field","currency_id","CONFIG","defaultCurrencyId","instance","setSelectEvent","AppConnector","request","action","record","responseData","id","done","result","errorLog","subProductsCashe","loadSubProducts","indicator","recordId","recordModule","removeSubProducts","inArray","addSubProducts","progressIndicator","progressInstace","hide","fail","subProductsContainer","remove","append","priductText","mapResultsToFields","referenceModule","description","recordData","unitPriceValues","unitPriceValuesJson","parameters","type","next","editorInstance","CKEDITOR","instances","commentElement","setData","unit","triggerQtyParam","qtyPerUnit","perUnit","saveDiscountsParameters","info","panels","push","saveTaxsParameters","extend","showExpandedRow","inventoryRowExpanded","getInstance","key","listInstance","loadEditorElement","hideExpandedRow","destroy","initDiscountsParameters","parameter","isArray","array","arrayValue","filter","change","initTaxParameters","toString","input","formatNumber","limitEnableSave","account","limit","response","getModuleName","mode","currency","async","dataType","status","showModalWindow","currencyChangeActions","select","option","currencyConvertValues","showCurrencyChangeModal","lockCurrencyChange","block","currencyParam","date","rate","conversion","hideModalWindow","one","previous","prevConversionRate","setRowData","rowData","autoFields","unitText","subunit","subunitText","comment1","net","gross","total","discountparam","discountParam","taxparam","tax_percent","addItem","baseTableId","sequenceNumber","replaced","replace","moduleLbls","children","initItem","registerAutoCompleteFields","registerAddItem","itemsHeader","btn","registerSortableItems","sortable","handle","revert","tolerance","placeholder","helper","e","ui","width","start","event","item","startPos","stop","child","numrow","after","before","registerShowHideExpanded","currentTarget","registerPriceBookModal","registerRowChangeEvent","headContainer","registerSubProducts","registerClearReferenceSelection","referenceGroup","registerDeleteLineItemEvent","num","registerChangeDiscount","view","relatedRecord","hasClass","totalPrice","discountType","registerChangeDiscountModal","checked","registerChangeTax","sourceRecord","getRecordId","registerChangeTaxModal","registerChangeCurrency","symbol","registerRowAutoComplete","sourceFieldElement","referenceSelectionEvent","selectedModule","dataUrl","i","Picklist","showSelect2ElementView","Date","register","validationEngineOptions","loadInventoryData","sourceModule","success","progressLoader","blockInfo","enabled","resolve","reject","addBtn","activeModules","Object","keys","first","currencyparam","discountmode","taxmode","oldCurrencyChangeAction","indexOf","moduleName","Vtiger_Helper_Js","showMessage","vtranslate","basetableid","error","err"],"mappings":"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"}